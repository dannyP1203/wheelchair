<?xml version='1.0'?>
<launch>

	<arg name="use_custom_hw_interface" default="false" />
	<arg name="use_effort" 							default="true" />

	<!-- Gazebo -->
	<include file="$(find wheelchair_gazebo)/launch/wheelchair_gazebo.launch">
		<arg name="world" value="dipartimento" />
		<arg name="use_pid" value="false" />
		<arg name="custom_hw_interface" value="$(arg use_custom_hw_interface)" />
		<arg name="custom_controller" value="$(arg use_effort)" />
	</include>

	<!-- Load ros_control controller configurations -->
	<rosparam file="$(find wheelchair_sample_controllers)/config/joint_state_controller.yaml" command="load" />
	<rosparam file="$(find wheelchair_sample_controllers)/config/sample_diff_controller.yaml" command="load" />
	<rosparam file="$(find wheelchair_sample_controllers)/config/sample_effort_controller.yaml" command="load" />


	<!-- Start the controllers -->
	<node name="controller_spawner" pkg="controller_manager" type="spawner" output="screen"
		  args="joint_state_controller
				diff_sample_controller
				effort_sample_controller"
	/>

	<!-- Run the robot state publisher to publish TF -->
	<node pkg="robot_state_publisher" type="robot_state_publisher" name="robot_state_publisher" output="screen" >
		<param name="publish_frequency" type="double" value="50.0" />
	</node>

	<!-- Run Teleoperation -->
	<include file="$(find wheelchair_control)/launch/keyboard_teleop.launch" >
		<arg name="command_topic" value="cmd_vel" />
	</include>

	<!-- Localization -->
	<node pkg="tf" type="static_transform_publisher" name="static_map_to_odom_publisher" args="0 0 0 0 0 0 /map /odom 100"/>
	<node pkg="wheelchair_navigation" type="ground_truth_transform_broadcaster.py" name="ground_truth_transform_broadcaster" output="screen">
		<remap from="/ground_truth_odom" to="/odometry/ground_truth_odom" />
	</node>

	<!-- RViz -->
	<node pkg="rviz" type="rviz" name="rviz" args="-d $(find wheelchair_description)/config/wheelchair_base.rviz"/>

</launch>
